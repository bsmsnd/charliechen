(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{288:function(t,s,e){"use strict";e.r(s);var a=e(14),n=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"迁移至-vuepress"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#迁移至-vuepress"}},[t._v("#")]),t._v(" 迁移至 VuePress")]),t._v(" "),s("h2",{attrs:{id:"为什么迁移"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么迁移"}},[t._v("#")]),t._v(" 为什么迁移")]),t._v(" "),s("h4",{attrs:{id:"算笔经济账"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#算笔经济账"}},[t._v("#")]),t._v(" 算笔经济账")]),t._v(" "),s("p",[t._v("之前用WordPress搭建了个人网站"),s("code",[t._v("charliechen.cn")]),t._v("，除维护投入的时间成本外，搭建的成本主要是域名和服务器费用。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("项目")]),t._v(" "),s("th",[t._v("费用")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("域名")]),t._v(" "),s("td",[t._v("35 元 / 年")])]),t._v(" "),s("tr",[s("td",[t._v("服务器（腾讯云，标准型S2）")]),t._v(" "),s("td",[t._v("2,052 元 / 3 年")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("价格取自2023年1月26日腾讯云服务器CVM-标准型S2广州区。价格可能变化。")])]),t._v(" "),s("h4",{attrs:{id:"个人维护成本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#个人维护成本"}},[t._v("#")]),t._v(" 个人维护成本")]),t._v(" "),s("p",[t._v("在网站开通的几年间，尽管此网站不存储任何个人信息，但仍遭遇过一次DDoS攻击，导致服务器瘫痪。后来在腾讯客服小姐姐的帮助下才得以恢复。这个过程学到了很多，但是也让我看到了网站运营不易。")]),t._v(" "),s("p",[t._v("此外，由于个人网站预算有限，云服务器算力和带宽有限，因此每次网页的访问或文章上传成本较高。插件的使用（我主要使用的插件是Jetpack，从文章编辑和网站监控等方面提供了丰富的支持）更加剧了这一困境。")]),t._v(" "),s("p",[t._v("基于上面的两点考虑，我一直在寻找个人博客的替代方案。这个时候，GitHub Pages成为了一个不错的选择。加之我平时文档大都使用Markdown，VuePress作为MD文档的静态网站生成器兼具易用性和可拓展性，用这一组合托管文档再合适不过。")]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://jekyllrb.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jekyll"),s("OutboundLink")],1),t._v("是GitHub官方推荐的GitHub Pages的网站“生成器”。这个"),s("a",{attrs:{href:"https://stackshare.io/stackups/hugo-vs-jekyll-vs-vuepress",target:"_blank",rel:"noopener noreferrer"}},[t._v("网页"),s("OutboundLink")],1),t._v("提供了两个工具的比较。")])]),t._v(" "),s("h2",{attrs:{id:"vuepress-github-pages-github-actions-如何搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vuepress-github-pages-github-actions-如何搭建"}},[t._v("#")]),t._v(" VuePress + GitHub Pages + GitHub Actions 如何搭建")]),t._v(" "),s("p",[t._v("GitHub Pages本质是一个静态网站托管。它会主动取用仓库文件作为网站文件发送给访问者。VuePress则是一个静态网站的“生成器”，可以将MD文档转化成静态的HTML页面。")]),t._v(" "),s("h3",{attrs:{id:"getting-started"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting Started")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://vuepress.vuejs.org/guide/getting-started.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("VuePress官网"),s("OutboundLink")],1),t._v("提供了非常完整的入门教程，对于新手非常友好。为了避免后续部署出现问题，我在这个位置还创建了一个Ubuntu的虚拟机，用以测试网站部署的效果。仅验证网站部署情况的话，只需看完官方指南的"),s("a",{attrs:{href:"https://vuepress.vuejs.org/zh/guide/getting-started.html#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B",target:"_blank",rel:"noopener noreferrer"}},[t._v("“快速上手”"),s("OutboundLink")],1),t._v("部分，能够正确在本地启动即可。")]),t._v(" "),s("h3",{attrs:{id:"部署到github-pages"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署到github-pages"}},[t._v("#")]),t._v(" 部署到GitHub Pages")]),t._v(" "),s("p",[t._v("在VuePress官方教程中提供了"),s("a",{attrs:{href:"https://vuepress.vuejs.org/zh/guide/deploy.html#github-pages",target:"_blank",rel:"noopener noreferrer"}},[t._v("部署到GitHub Pages"),s("OutboundLink")],1),t._v("的完整步骤。这一步所创建的脚本"),s("code",[t._v("deploy.sh")]),t._v("可以整合在CI中，从而在每次"),s("code",[t._v("git push")]),t._v("时可以自动执行生成静态网站的脚本。不论部署的域名是什么，都推荐将静态网址生成的内容保存到"),s("code",[t._v("gh-pages")]),t._v("分支上，以避免和"),s("code",[t._v("main")]),t._v("分支作用重叠。")]),t._v(" "),s("p",[t._v("要将部署步骤整合到CI中，GitHub提供的GitHub Actions可以做到。但官方提供的范例YAML文件可用性不高。这里整理下亲测可用步骤。")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("创建 "),s("a",{attrs:{href:"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub access token"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("在GitHub仓库设置中的Actions secrets and variables，创建一个Repository secrets，填入刚创建的 "),s("code",[t._v("token")]),t._v("，将Name设为"),s("code",[t._v("ACCESS_TOKEN")]),t._v("。")])]),t._v(" "),s("li",[s("p",[t._v("确认在"),s("code",[t._v("package.json")]),t._v("目录下，已经添加了Getting Started步骤中要求添加的脚本。")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"docs:dev"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vuepress dev docs"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"docs:build"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vuepress build docs"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("在仓库中创建"),s("code",[t._v(".github/workflows")]),t._v("目录，并创建"),s("code",[t._v("vuepress-deploy.yml")]),t._v("文件。 （注：源码来源参见 References）")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# name 可以自定义")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy to GitHub Pages\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 触发条件：在 push 到 main/master 分支后，新的 Github 项目 应该都是 main，而之前的项目一般都是 master")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" main\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 任务")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build-and-deploy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 服务器环境：最新版 Ubuntu")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 拉取代码")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v2\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("persist-credentials")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成静态文件")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Build\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm install "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&&")]),t._v(" npm run docs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("build "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如仓库的包管理器是yarn，则应执行yarn && yarn docs:build")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 部署到 GitHub Pages")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" JamesIves/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deploy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@releases/v3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ACCESS_TOKEN")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.ACCESS_TOKEN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 也就是我们刚才生成的 secret")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("BRANCH")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 部署到 gh-pages 分支，因为 main 分支存放的一般是源码，而 gh-pages 分支则用来存放生成的静态文件")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("FOLDER")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" docs/.vuepress/dist "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vuepress 生成的静态文件存放的地方")]),t._v("\n\n")])])])]),t._v(" "),s("li",[s("p",[t._v("将上述修改提交至main分支，稍等几分钟可以看到Action执行完毕，并自动将生成的文件推送至"),s("code",[t._v("gh-pages")]),t._v("。")])]),t._v(" "),s("li",[s("p",[t._v("设置GitHub Pages。在仓库设置中的“Pages”，选择Source为Deploy from a branch，并将对应的branch设置为"),s("code",[t._v("gh-pages")]),t._v("，即部署使用的分支名称。")])])]),t._v(" "),s("h2",{attrs:{id:"后续"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后续"}},[t._v("#")]),t._v(" 后续")]),t._v(" "),s("p",[t._v("国内访问GitHub愈发堪忧，在这篇文章写作过程中，我访问此仓库基本都是超时的。在切换至GitHub Pages后可能会导致受众变化（特别是考虑到，我之前的网址是"),s("code",[t._v(".cn")]),t._v("，有完整备案的）。注意到gitee可以提供相似的服务，后续会考虑在多平台推送以保证国内可以正常访问。")]),t._v(" "),s("p",[t._v("GitHub Pages还支持自定义域名，这也让我开始考虑启用新的域名。")]),t._v(" "),s("h2",{attrs:{id:"references"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[t._v("#")]),t._v(" References")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/365548465",target:"_blank",rel:"noopener noreferrer"}},[t._v("为什么你的WordPress网站速度那么慢？ - 知乎 (zhihu.com)"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://juejin.cn/post/7000572105154625567",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vuepress + GitHub Actions 实现博客自动部署！ - 掘金 (juejin.cn)"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);